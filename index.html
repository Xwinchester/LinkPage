<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Probing Cheat Sheet</title>    
<style>
    body {
        background-color: #222;
        color: #fff;
        font-family: 'Arial', sans-serif;
	font-size: 16px;
        line-height: 1.6;
        margin: 0;
        padding: 20px;
    }

    h1, h2 {
        color: #00bcd4;
    }

    p {
	font-size: 14px;
	color: #00bcd4;
	margin-left: 10px;
    }

    code {
        background-color: #333;
        color: #00bcd4;
        padding: 5px 5px;
        border-radius: 3px;
    }

    .dark-mode-toggle {
        position: fixed;
        top: 10px;
        right: 10px;
        cursor: pointer;
        padding: 5px;
        background-color: #333;
        color: #00bcd4;
        border: none;
        border-radius: 5px;
    }

    .dark-mode {
        background-color: gray;
        color: white;
    }
	

    ul {
        list-style-type: none;
        padding: 8px;
    }

    li {
	border-radius: 5px;
        margin-top: 10px;
	padding: 10px;
	background-color: #444;
    }

    select,
    input {
        padding: 5px;
        border: 1px solid #333;
        border-radius: 3px;
        background-color: #333;
        color: #fff;
	width: 99%;
    }

    select:hover,
    input:hover {
        border-color: #00bcd4;
    }

    select:focus,
    input:focus {
        outline: none;
        border-color: #00bcd4;
    }

    button {
        padding: 5px 10px;
        background-color: #00bcd4;
        color: #fff;
        border: none;
        border-radius: 3px;
        cursor: pointer;
        margin: 10px;
    }

    button:hover {
        background-color: #0097a7;
    }
    
</style>

</head>
<body>	
	<header>
		<h1>Probing Cheat Sheet</h1>
	</header>

    <ul>
    	<li>
    		<h2>Machine</h2>
                <select id="machine">
                    <option value="G65P98">Feeler</option>
                    <option value="G65P95">MX-520</option>
                </select>    		
    	</li>
		<li>
			<h2>Probe On</h2>
			<code id="probe_on">G65P9832(PROBE ON)</code><button onclick="copyText('probe_on')">Copy</button>
		</li>
		<li>
			<h2>Probe Off</h2>
			<code id="probe_off">G65P9833(PROBE OFF)</code><button onclick="copyText('probe_off')">Copy</button>
		</li>
		<li>
			<h2>PPM  - Protected Positioning Movement</h2>
				<code id="ppm">G65P9810(PPM)</code><button onclick="copyText('ppm')">Copy</button>
				<ul>
					<li>X Position: <input type="text" id="ppm_x" placeholder="X Position"></input></li>
					<li>Y Position: <input type="text" id="ppm_y" placeholder="Y Position"></input></li>
					<li>Z Position: <input type="text" id="ppm_z" placeholder="Z Position"></input></li>
					<li>Feed: <input type="text" id="ppm_feed" placeholder="Defaults to 39.37( Not required )"></input></li>
				</ul>
		</li> 
	   <li>
			<h2>Single Point</h2>
			<code id="single_pt">G65P9811(SINGLE PT)</code><button onclick="copyText('single_pt')">Copy</button>
			<ul>
				<li>
					Axis: 
					<select id="single_pt_axis">
						<option value="X">X</option>
						<option value="Y">Y</option>
						<option value="Z" selected>Z</option>
					</select>
				</li>
				<li>Position: <input type="text" id="single_pt_pos" placeholder="Probing Position"></input></li>
				<li><label for="single_pt_wcs">WCS: </label><select id="single_pt_wcs"></select></li>
				<li>Overtravel: <input type="text" id="single_pt_overtravel" placeholder="If Blank, Defaults to .400 ( Not Required )"></input></li>
			</ul>
		</li>
		<li>
			<h2>Web / Pocket - Start at Center of Feature</h2>
			<code id="web_pocket">G65P9812(WEB / POCKET)</code><button onclick="copyText('web_pocket')">Copy</button>
			<ul>
				 <li>
					Axis: 
					<select id="web_pocket_axis">
						<option value="X">X</option>
						<option value="Y">Y</option>
					</select>
				</li>
				<li>Width Of Feature: <input type="text" id="web_pocket_width" placeholder="Width of Feature" value=""></input></li>
				<li>Z Position: <input type="text" id="web_pocket_pos" placeholder="Web uses Z, Pocket = No Z" value=""></input></li>
				<li>Radial Clearance: <input type="text" id="web_pocket_radial" placeholder="Defaults to .400( Not Required )" value=""></input></li>
				<li>
					WCS: 
					<select id="web_pocket_wcs"></select>
				</li>
			</ul>
		</li>
		<li>
			<h2>Bore / Boss</h2>
			<code id="bore_boss">G65P9814(BORE / BOSS)</code><button onclick="copyText('bore_boss')">Copy</button>
			<ul>
			<li>X Position: <input type="text" id="bore_boss_x" placeholder="Nominal X Position of Feature" value=""></input></li>
			<li>Y Position: <input type="text" id="bore_boss_y" placeholder="Nominal Y Position of Feature" value=""></input></li>	
			<li>Diameter of Feature: <input type="text" id="bore_boss_diameter" placeholder="Diameter of Feature" value=""></input></li>
			<li>Z Position ( Only For Boss ): <input type="text" id="bore_boss_z" placeholder="Boss Requires Z, Bore = Leave Blank" value=""></input></li>
			<li>Radial Clearance: <input type="text" id="bore_boss_radial" placeholder="Defaults to .400( Not Required )" value=""></input></li>
				<li>
					WCS: 
					<select id="bore_boss_wcs"></select>
				</li>
			</ul>
		</li>       
		<li>
			<h2>5 Point rectangle External - Start at Center of Rectangle</h2>
			<code id="external_rectangle">G65P9817</code><button onclick="copyText('external_rectangle')">Copy</button>
			<ul>
			<li>Nominal Width in X Axis: <input type="text" id="external_rectangle_x_width" placeholder="Width of Rectangle in X" value=""></input></li>
			<li>Nominal Width in Y Axis: <input type="text" id="external_rectangle_y_width" placeholder="Width of Rectangle in Y" value=""></input></li>
			<li>Z Measuring Hight Position: <input type="text" id="external_rectangle_z" placeholder="Z Position for Probe Points" value=""></input></li>
			<li>Radial Clearance: <input type="text" id="external_rectangle_radial" placeholder="Defaults to .400( Not Required )" value=""></input></li>
			<li><label for="external_rectangle_wcs">WCS: </label><select id="external_rectangle_wcs"></select></li>
				<li>
					Location of the 2 Probing Points: 
					<select id="external_double_points">
						<option value="">Y Minus</option>
						<option value="A11.">X Plus</option>
						<option value="A12.">Y Plus</option>
						<option value="A13.">X Minus</option>
					</select>
				</li>            
			</ul>
        </li>
        <li>
            <h2>Feature to Feature - Use X & Y or A & D (**Cannot use Both**)</h2>
            <code id="feature_to_feature">G65P9834(STORE DATA)</code><button onclick="copyText('feature_to_feature')">Copy</button>
            <ul>
                <li>X Incremental Distance: <input type="text" id="feature_to_feature_x_inc" placeholder="Incremental Distance in X From Point 1 to Point 2" value=""></input></li>
                <li>Y Incremental Distance: <input type="text" id="feature_to_feature_y_inc" placeholder="Incremental Distance in X From Point 1 to Point 2" value=""></input></li>
                <li>Nominal Angle: <input type="text" id="feature_to_feature_angle" placeholder="Nominal Desired Angle From Point 1 to Point 2" value=""></input></li>
               <li>Nominal Distance: <input type="text" id="feature_to_feature_distance" placeholder="Nominal Desired Distance From Point 1 to Point 2" value=""></input></li>
            </ul>
        </li>
    </ul>
	
    <h2>Renishaw Probing Output Variables</h2>
    <ul>
        <li><code>#135</code> - X Position</li>
        <li><code>#136</code> - Y Position</li>
        <li><code>#137</code> - Z Position</li>
        <li><code>#138</code> - Size</li>
        <li><code>#140</code> - X Error</li>
        <li><code>#141</code> - Y Error</li>
        <li><code>#142</code> - Z Error</li>
        <li><code>#143</code> - Size Error</li>
        <li><code>#145</code> - True Position Error</li>
    </ul>

    <button class="dark-mode-toggle" onclick="toggleDarkMode()">Toggle Dark Mode</button>

    <script>
        function toggleDarkMode() {
            document.body.classList.toggle('dark-mode');
        }
    </script>
	<script>
	
	const comment_brackets = ["(", ")" ];
	
    // Function to copy text to clipboard
    function copyText(elementId) {
        var textElement = document.getElementById(elementId);
        var textToCopy = textElement.textContent || textElement.innerText;

        var tempInput = document.createElement('input');
        tempInput.value = textToCopy;
        document.body.appendChild(tempInput);

        tempInput.select();
        tempInput.setSelectionRange(0, 99999);
        document.execCommand('copy');

        document.body.removeChild(tempInput);
    }
	
	// Function to create WCS select element
    function createWcsSelect(id,  wcsOptions) {
        var selectElement = document.getElementById(id);
		var wcsOptions =  [
            { value: 'S1.', label: 'G54' },
            { value: 'S2.', label: 'G55' },
			{ value: 'S3.', label: 'G56' },
			{ value: 'S4.', label: 'G57' },
			{ value: 'S5.', label: 'G58' },			  
            { value: 'S6.', label: 'G59' },
            { value: 'S101.', label: 'G54.1P1' },
			{ value: 'S102.', label: 'G54.1P2' },
			{ value: 'S103.', label: 'G54.1P3' },
			{ value: 'S104.', label: 'G54.1P4' },
            { value: '', label: 'N/A' }
        ];
        // Clear existing options
        selectElement.innerHTML = '';

        // Add default option
        var defaultOption = document.createElement('option');
        defaultOption.value = '';
        defaultOption.text = wcsOptions[0].label;

        // Add WCS options
        wcsOptions.forEach(function (option) {
            var wcsOption = document.createElement('option');
            wcsOption.value = option.value;
            wcsOption.text = option.label;
            selectElement.appendChild(wcsOption);
        });
    }

    // Function to update probe codes
    function updateProbe(onCode, offCode) {
        var machineId = document.getElementById('machine');
        var codeValue = machineId.value;
        var onElement = document.getElementById(onCode);
        var offElement = document.getElementById(offCode);
		
	    function updateProbingOperation() {
            var machineInput = machineId.value;
			var setupModeValue = "";
			if (machineInput == "G65P95"){
				setupModeValue =  "D1.";
			}
            onElement.textContent = machineInput +  + "32" + setupModeValue + "(PROBE ON)";
			offElement.textContent = machineInput + "33(PROBE OFF)";
        }
		
		machineId.addEventListener('input', updateProbingOperation);				        
    }

    // Function to update code for various operations
    function updateCode(codeId, comment, operationCode, params) {
        var codeElement = document.getElementById(codeId);
        var selectedMachine = document.getElementById('machine');

        function updateOperation() {
            var machineInput = selectedMachine.value;
            var codeValue = operationCode;
            for (var param of params) {
                var inputElement = document.getElementById(param.id);
                var paramValue = inputElement.value.trim() !== '' ? param.prefix + inputElement.value : '';
                codeValue += paramValue;
            }
            codeElement.textContent = machineInput + codeValue + comment_brackets[0] + comment + comment_brackets[1];
        }

        selectedMachine.addEventListener('input', updateOperation);

        for (var param of params) {
            var inputElement = document.getElementById(param.id);
            inputElement.addEventListener('input', updateOperation);
        }

        // Run the update function on page load
        window.onload = updateOperation;
    }

    // Update probe codes
    updateProbe('probe_on', 'probe_off');

    // Update PPM code
    updateCode('ppm', 'PPM', '10', [
        { id: 'ppm_x', prefix: 'X' },
        { id: 'ppm_y', prefix: 'Y' },
        { id: 'ppm_z', prefix: 'Z' },
        { id: 'ppm_feed', prefix: 'F' }
    ]);

    // Update Single Point code
    updateCode('single_pt', 'SINGLE PT', '11', [
        { id: 'single_pt_axis', prefix: '' },
        { id: 'single_pt_pos', prefix: '' },
        { id: 'single_pt_wcs', prefix: '' },
        { id: 'single_pt_overtravel', prefix: 'Q' }
    ]);

    // Update Web / Pocket code
    updateCode('web_pocket', 'WEB / POCKET', '12', [
        { id: 'web_pocket_axis', prefix: '' },
        { id: 'web_pocket_width', prefix: '' },
        { id: 'web_pocket_pos', prefix: 'Z' },
        { id: 'web_pocket_radial', prefix: 'R' },
        { id: 'web_pocket_wcs', prefix: '' }
    ]);

    // Update Bore / Boss code
    updateCode('bore_boss', 'BORE / BOSS',  '14', [
        { id: 'bore_boss_x', prefix: 'X' },
        { id: 'bore_boss_y', prefix: 'Y' },
        { id: 'bore_boss_diameter', prefix: 'D' },
        { id: 'bore_boss_z', prefix: 'Z' },
        { id: 'bore_boss_radial', prefix: 'R' },
        { id: 'bore_boss_wcs', prefix: '' }
    ]);

    // Update External Rectangle code
    updateCode('external_rectangle', '5 PT RECTANGLE', '17', [
        { id: 'external_rectangle_x_width', prefix: 'D' },
        { id: 'external_rectangle_y_width', prefix: 'E' },
        { id: 'external_rectangle_z', prefix: 'Z' },
        { id: 'external_rectangle_radial', prefix: 'R' },
        { id: 'external_rectangle_wcs', prefix: '' },
        { id: 'external_double_points', prefix: '' }
    ]);
	
	
	// Update feature_to_featuree code
    updateCode('feature_to_feature', 'STORE DATA', '34', [
        { id: 'feature_to_feature_x_inc', prefix: 'X' },
        { id: 'feature_to_feature_y_inc', prefix: 'Y' },
        { id: 'feature_to_feature_angle', prefix: 'A' },
        { id: 'feature_to_feature_distance', prefix: 'D' }
    ]);

	
	
	// Creates all of the elements inside the wcs select 
    createWcsSelect('web_pocket_wcs');
    createWcsSelect('single_pt_wcs');
	createWcsSelect('bore_boss_wcs');
	createWcsSelect('external_rectangle_wcs');
</script>

</body>
</html>
